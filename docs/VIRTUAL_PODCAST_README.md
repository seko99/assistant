# Виртуальный Подкаст

Система генерации виртуальных подкастов с использованием ИИ-участников на базе существующих компонентов Speech Assistant.

## Описание

Виртуальный подкаст создает интерактивное обсуждение заданной темы между четырьмя ИИ-персонажами:
- **Максим** (модератор) - опытный журналист, управляет ходом беседы
- **Анна** (техэксперт) - IT-специалист, освещает технические аспекты
- **Дмитрий** (бизнес-аналитик) - экономист и стратег
- **Елена** (социолог) - эксперт по социальным процессам

## Возможности

✅ **Автоматическое создание подкастов** - просто укажите тему
✅ **Разные голоса** - каждый участник имеет уникальный голос Silero TTS
✅ **Контекстное обогащение** - поиск дополнительной информации по теме
✅ **Гибкие настройки** - количество раундов, формат вывода, участники
✅ **Сохранение результатов** - транскрипт в JSON и Markdown, аудиофайлы
✅ **CLI интерфейс** - удобное управление через командную строку

## Установка

### Требования

- Python 3.8+
- PyTorch + CUDA (опционально, для ускорения TTS)
- Локальный LLM сервер (LMStudio или аналог)
- Необходимые Python пакеты (см. requirements.txt)

### Дополнительные зависимости для подкастов

```bash
pip install torchaudio
```

## Использование

### Быстрый старт

```bash
# Базовый подкаст на 3 раунда
python virtual_podcast.py --topic "Искусственный интеллект"

# Короткий подкаст без аудио
python virtual_podcast.py --topic "Будущее работы" --rounds 2 --no-audio

# Интерактивный режим
python virtual_podcast.py
```

### Параметры командной строки

```bash
python virtual_podcast.py [опции]

Опции:
  --topic, -t ТЕМА          Тема подкаста для обсуждения
  --rounds, -r ЧИСЛО        Количество раундов (по умолчанию: 3)
  --output-dir, -o ПУТЬ     Директория для сохранения результатов
  --no-audio                Генерировать только текст без аудио
  --config, -c ФАЙЛ         Путь к файлу конфигурации (config.json)
  --list-voices             Показать доступные голоса
  --dry-run                 Тестовый запуск без генерации
  --verbose, -v             Подробный вывод
  --help, -h                Показать справку
```

### Примеры

```bash
# Подкаст о технологиях
python virtual_podcast.py -t "Блокчейн и криптовалюты" -r 2

# Социальная тема
python virtual_podcast.py -t "Влияние соцсетей на общество" --verbose

# Только текст в кастомную папку
python virtual_podcast.py -t "Климатические изменения" --no-audio -o ./my_podcasts
```

## Конфигурация

Настройки подкаста находятся в секции `podcast` файла `config.json`:

```json
{
  "podcast": {
    "default_rounds": 3,
    "default_output_format": "both",
    "enable_search": true,
    "search": {
      "provider": "mock",
      "max_results": 5,
      "timeout": 10
    },
    "participants": {
      "moderator": {
        "name": "Максим",
        "role": "moderator",
        "voice": {
          "speaker_name": "aidar",
          "speed": 1.0,
          "volume": 1.0
        },
        "personality": "Опытный журналист...",
        "expertise": ["журналистика", "медиа"],
        "system_prompt": "Ты - ведущий подкаста...",
        "temperature": 0.6
      }
    }
  }
}
```

### Настройка участников

Каждый участник имеет следующие параметры:

- `name` - отображаемое имя
- `role` - роль ("moderator" или "speaker")
- `voice.speaker_name` - голос Silero TTS
- `personality` - описание личности
- `expertise` - области экспертизы
- `system_prompt` - системный промпт для LLM
- `temperature` - температура для LLM (0.0-1.0)

### Доступные голоса

| Голос | Описание | Участник по умолчанию |
|-------|----------|----------------------|
| aidar | Мужской голос | Максим (модератор) |
| kseniya | Женский голос | Анна (техэксперт) |
| eugene | Мужской голос | Дмитрий (аналитик) |
| baya | Женский голос | Елена (социолог) |

## Структура проекта

```
podcast/
├── __init__.py              # Инициализация модуля
├── session.py               # Управление сессией подкаста
├── persona.py               # Профили участников
├── context_enricher.py      # Обогащение контекста темы
├── context_splitter.py      # Распределение контекста
└── orchestrator.py          # Основной оркестратор

virtual_podcast.py           # Главный скрипт CLI
tests/                       # Тесты компонентов
├── test_podcast_session.py
├── test_context_enricher.py
├── test_persona.py
└── run_tests.py
```

## Результаты работы

После выполнения подкаст сохраняется в директории `output/podcast_YYYYMMDD_HHMMSS/`:

```
output/podcast_20241201_143052/
├── transcript.json          # Полный транскрипт с метаданными
├── transcript.md            # Человекочитаемый транскрипт
├── moderator_opening_*.wav  # Аудиофайлы по участникам
├── tech_expert_response_*.wav
└── ...
```

### Формат транскрипта

**JSON формат** содержит:
- Полные метаданные сессии
- Временные метки всех реплик
- Ссылки на аудиофайлы
- Журнал событий сессии
- Контекст и настройки участников

**Markdown формат** содержит:
- Читаемый транскрипт с временными метками
- Информацию о теме и участниках
- Структурированный по выступлениям текст

## Тестирование

```bash
# Запуск всех тестов
python tests/run_tests.py

# Проверка конфигурации
python virtual_podcast.py --dry-run

# Тест без реального выполнения
python virtual_podcast.py --topic "Тест" --dry-run --verbose
```

## Технические детали

### Архитектура

1. **PodcastOrchestrator** - управляет общим ходом подкаста
2. **ParticipantManager** - управляет участниками и их профилями
3. **ContextEnricher** - обогащает тему дополнительной информацией
4. **ContextSplitter** - распределяет контекст между участниками
5. **LLMSession** - независимые диалоги для каждого участника
6. **TextToSpeech** - синтез речи с поддержкой разных голосов

### Интеграция с существующими компонентами

Система переиспользует существующие компоненты Speech Assistant:
- `LLMEngine` - расширен поддержкой независимых сессий
- `TextToSpeech` - добавлена поддержка разных голосов и сохранения
- `utils.config` - используется существующий механизм конфигурации

### Ограничения

- Требует запущенный локальный LLM сервер
- Mock поиск - для реального поиска нужна интеграция с поисковыми API
- Голоса ограничены набором Silero TTS
- Производительность зависит от скорости LLM и TTS

## Разработка

### Добавление нового участника

1. Создать профиль в `persona.py` или добавить в `config.json`
2. Настроить голос и системный промпт
3. При необходимости изменить логику в `orchestrator.py`

### Добавление провайдера поиска

1. Реализовать класс наследующий `SearchProvider` в `context_enricher.py`
2. Добавить создание провайдера в `_create_search_provider()`
3. Настроить в конфигурации секцию `search.provider`

### Расширение функциональности

- Добавление новых форматов вывода
- Интеграция с внешними поисковыми API
- Поддержка тематических шаблонов
- Интерактивное управление во время записи

## Лицензия

Apache License 2.0